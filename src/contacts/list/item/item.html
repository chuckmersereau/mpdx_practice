<div ng-if="$ctrl.view == 'minimal'" class="contact-row">
    <a ng-click="$ctrl.switchContact()" ng-class="{'active': $ctrl.selected == $ctrl.contact.id }">{{$ctrl.contact.name}}</a>
</div>
<div ng-if="$ctrl.view !== 'minimal'" class="contact-row" ng-click="$ctrl.contacts.selectContact($ctrl.contact.id)">
    <img class="avatar small" ng-src="{{$ctrl.contact.square_avatar | stripMpdx}}">
    <div class="contact-details">
        <div class="col-sm-5 main-details">
            <h4 class="name">
                <a ui-sref="contacts.show({contactId: $ctrl.contact.id})" ng-click="$event.stopPropagation()">{{$ctrl.contact.name}}</a>
                <i ng-class="{'icon-error-red': $ctrl.hasSendNewsletterError()}" class="ci ci-letter_icon" title="{{$ctrl.contact.send_newsletter | translate}}" ng-if="$ctrl.contact.send_newsletter"></i>
                <span title="{{ 'Partner - Special' | translate }}" ng-if="$ctrl.contact.status === 'Partner - Special'">
                    <span>{{$ctrl.contact.pledge_currency_symbol}}</span>
                </span>
                <span title="{{ 'Partner - Financial' | translate }}" ng-if="$ctrl.contact.status === 'Partner - Financial'">
                    <span>{{$ctrl.contact.pledge_currency_symbol}}</span>
                    <span>{{$ctrl.contact.pledge_currency_symbol}}</span>
                </span>
            </h4>
            <div class="people" ng-if="$ctrl.view !== 'task'">
                <div ng-repeat="person in $ctrl.contact.people track by person.id" ng-if="!person.deceased" class="people-single-contact">
                    <a ng-click="$ctrl.people.openPeopleModal($ctrl.contact, person.id); $event.stopPropagation()">{{person.first_name}} {{person.last_name}}</a>
                    <span ng-repeat="phone_number in person.phone_numbers" ng-if="phone_number.primary && !phone_number.historic" class="phone-type phone-type-{{phone_number.location}}">
                        {{phone_number.number}}
                    </span>
                    <a ng-repeat="email_address in person.email_addresses" ng-if="email_address.primary && !email_address.historic" ng-href="mailto:{{email_address.email}}">
                        <i class="ci ci-email_icon" title="{{ 'Email' | translate }}"></i>
                    </a>
                    <a ng-repeat="facebook_account in person.facebook_accounts" ng-href="{{facebook_account.url}}" target="_blank">
                        <i class="fa fa-facebook-square" title="{{ 'Facebook profile' | translate }}"></i>
                    </a>
                </div>
            </div>
            <div class="tags">
                <span class="tag" ng-repeat="tag in $ctrl.contact.tag_list">{{ tag |limitTo: 20 }}{{ tag.length > 20 ? '...' : '' }}</span>
            </div>
        </div>
        <div class="col-sm-5 more-details">
            <div ng-if="$ctrl.contact.status !== ''">{{$ctrl.contact.status | translate}}</div>
            <div ng-if="$ctrl.contact.pledge_amount > 0">
                {{$ctrl.contact.pledge_amount | currency: $ctrl.contact.pledge_currency_symbol}} {{$ctrl.contact.pledge_frequency | pledgeFrequencyToStr | translate}}
                <div ng-if="$ctrl.contact.status == 'Partner - Financial'" ng-switch="$ctrl.contact.pledge_received">
                    <div ng-switch-when="true" class="text-success" translate>Commitment Received</div>
                    <div ng-switch-when="false" class="text-warning" translate>Commitment Not Received</div>
                </div>
            </div>

            <a ui-sref="tasks({ filters: { contact_ids: $ctrl.contact.id } })" ng-if="$ctrl.contact.uncompleted_tasks_count > 0" ng-click="$event.stopPropagation()">
                <span translate>Tasks</span>: {{$ctrl.contact.uncompleted_tasks_count}}
            </a>
        </div>
        <div class="col-sm-2 text-right" ng-if="$ctrl.view !== 'task'">
            <div class="btn-group">
                <a class="btn btn-sm btn-default" ui-sref="contacts.show({contactId: $ctrl.contact.id})" title="{{ 'View Contact' | translate }}" ng-click="$event.stopPropagation()">
                    <i class="fa fa-search"></i>
                </a>
                <a class="btn btn-sm btn-default" title="{{ 'Hide Contact' | translate }}" ng-if="$ctrl.contact.status !== 'Never Ask'" ng-click="$ctrl.hide({ contactId: $ctrl.contact.id }); $event.stopPropagation()">
                <i class="fa fa-eye-slash"></i>
            </a>
        </div>
    </div>
</div>
</div>
