<modal title="{{'Edit Task' | translate}}" save="$ctrl.save()" delete="$ctrl.delete()" cancel="$hide()" show-delete="true">
    <div class="form-group">
        <label for="subject"><translate>Task Name</translate> <span class="text-danger">*</span></label>
        <input class="form-control" id='subject' ng-model="$ctrl.task.subject" autofocus required>
    </div>
    <div class="form-group">
        <label for="action"><translate>Action</translate></label>
        <select chosen
                disable-search="true"
                class="form-control"
                id="action"
                name="action"
                ng-options="opt.id as opt.value for opt in $ctrl.serverConstants.data.activity_hashes"
                ng-model="$ctrl.task.activity_type">
            <option value=""></option>
        </select>
    </div>
    <div class="form-group" ng-if="$ctrl.task.activity_type === 'Appointment'">
        <label for="location" translate>Location</label>
        <input type="text"
               name="location"
               id="location"
               class="form-control"
               places-auto-complete
               ng-model="$ctrl.task.location">
    </div>
    <div class="row">
        <div class="col-md-6">
            <div ng-if="$ctrl.task.completed" class="form-group">
                <label for="completed" translate>Completed On</label>
                <datetimepicker ng-model="$ctrl.task.completed_at" id="completed"></datetimepicker>
            </div>
            <div ng-if="!$ctrl.task.completed" class="form-group">
                <label for="due-date" translate>Due Date</label>
                <datetimepicker ng-model="$ctrl.task.start_at" id="due-date"></datetimepicker>
            </div>
        </div>
        <div class="col-md-6">
            <label translate>Contacts</label>
            <contacts-selector ng-model="$ctrl.task.contacts" class="scrollable-tags"></contacts-selector>
        </div>
    </div>
    <div ng-if="$ctrl.task.completed" class="form-group">
        <label for="result" translate>Result</label>
        <select chosen
                ng-required="$ctrl.task.completed"
                disable-search="true"
                class="form-control"
                id='result'
                ng-options="opt for opt in $ctrl.serverConstants.data.results[$ctrl.task.activity_type.toLowerCase()] || $ctrl.serverConstants.data.results['default']"
                ng-model="$ctrl.task.result">
            <option value=""></option>
        </select>
    </div>
    <div class="row" ng-if="!$ctrl.task.completed">
        <div class="col-md-2"><label for="notification_type"><span class="no-wrap" translate>Notify me</span></label></div>
        <div class="col-md-2">
            <input type="number"
                   class="form-control"
                   ng-model="$ctrl.task.notification_time_before"
                   id="notification_type"
                   ng-required="$ctrl.task.notification_type"
                   min="0">
        </div>
        <div class="col-md-3">
            <select chosen
                    ng-model="$ctrl.task.notification_time_unit"
                    disable-search="true"
                    ng-required="$ctrl.task.notification_type">
                <option value="minutes">Minutes</option>
                <option value="hours">Hours</option>
            </select>
        </div>
        <div class="col-md-5 text-muted" translate>
            If blank, you will not be notified</span>
        </div>
    </div>
    <div class="form-group">
        <label translate>Tags</label>
        <tag-selector tag-list="$ctrl.tasksTags.data" ng-model="$ctrl.task.tag_list" class="scrollable-tags"></tag-selector>
    </div>
</modal>
