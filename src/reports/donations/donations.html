<div class="reports">
    <donations-chart in-contact="::$ctrl.inContact"></donations-chart>
    <h2 translate ng-if="::!$ctrl.inContact" class="mt-3 mb-4">
        <translate>Donations</translate>
        <span class="pull-right">
            <button ng-click="$ctrl.gotoPrevMonth()" class="btn btn-default">
                <i class="fas fa-angle-left"></i>
                <translate>Previous Month</translate>
            </button>
            <button ng-click="$ctrl.gotoNextMonth()" class="btn btn-default" ng-disabled="!$ctrl.enableNext">
                <translate>Next Month</translate>
                <i class="fas fa-angle-right"></i>
            </button>
        </span>
    </h2>
    <table class="table table-striped" ng-if="$ctrl.data.length > 0">
        <thead>
            <tr ng-if="::!$ctrl.inContact">
                <th colspan="8"><h4>{{$ctrl.startDate.format('MMMM YYYY')}}</h4></th>
            </tr>
            <tr>
                <th ng-if="::$ctrl.inContact" class="col-md-2" translate>Partner No.</th>
                <th class="col-md-2 date" translate>Date</th>
                <th ng-if="::!$ctrl.inContact" class="col-md-3" translate>Partner</th>
                <th class="col-md-1 text-right" translate>Amount</th>
                <th class="col-md-3" ng-if="$ctrl.designationAccounts.data.length > 0" translate>Designation</th>
                <th class="col-md-1" translate>Method</th>
                <th class="col-md-1" translate>Appeal</th>
                <th class="col-md-1"></th>
            </tr>
        </thead>
        <tbody>
            <tr ng-repeat="donation in $ctrl.data">
                <td ng-if="::$ctrl.inContact">{{ donation.donor_account.account_number }}</td>
                <td class="date">{{ donation.donation_date | date: $ctrl.locale.dateTimeFormat }}</td>
                <td ng-if="::!$ctrl.inContact">
                    <a ui-sref="contacts.show({ contactId: donation.contact.id })">{{ $ctrl.donations.displayName(donation) }}</a>
                </td>
                <td class="text-right">{{ donation.amount | currency:'':0 }} {{ donation.currency }}</td>
                <td>{{ donation.designation_account.display_name }}</td>
                <td>{{ donation.payment_method }}</td>
                <td>{{ donation.appeal.name }}</td>
                <td class="text-right"><a ng-click="$ctrl.donations.openDonationModal(donation)"><i class="far fa-pencil-square"></i></a></td>
            </tr>
        </tbody>
    </table>
    <pagination meta="$ctrl.meta.pagination"
                on-change="$ctrl.load(page)"
                class="text-center">
    </pagination>
    <table class="table table-striped" ng-if="$ctrl.data.length > 0">
        <tbody>
            <tr ng-repeat="(currency, total) in $ctrl.totals" ng-if="total > 0">
                <td class="text-right">
                    <strong translate-params-currency="currency" translate-params-count="total.count" translate>
                        Total {{currency}} Donations:
                    </strong>
                </td>
                <td class="text-right">
                    {{ total | currency:'':0 }} {{currency}}
                </td>
            </tr>
        </tbody>
    </table>
    <div class="blankslate" ng-class="{ 'blankslate-spacious' : !$ctrl.inContact }" ng-if="$ctrl.data.length === 0 && !$ctrl.loading">
        <i class="fas fa-money blankslate-icon"></i>
        <div ng-if="::$ctrl.inContact">
            <h3 translate>No donations received for this contact</h3>
            <p translate>Try adding a donation to a partner account associated with this contact.</p>
            <a ng-click="$ctrl.donations.openDonationModal()" class="btn btn-default" translate>Add New Donation</a>
        </div>
        <div ng-if="::!$ctrl.inContact">
            <h3 translate translate-params-month="$ctrl.startDate.format('MMMM YYYY')">No donations received in {{month}}</h3>
            <p translate>You can setup an organization account to import them or add a new donation.</p>
            <a ui-sref="preferences.integrations" class="btn btn-default" translate>Connect Services</a>
            <a ng-click="$ctrl.donations.openDonationModal()" class="btn btn-primary" translate>Add New Donation</a>
        </div>
    </div>
    <div class="blankslate blankslate-spacious" ng-if="$ctrl.loading">
      <i class="far fa-circle-notch fa-spin fa-3x fa-fw blankslate-icon blankslate-loading"></i>
    </div>
</div>
