<modal size="md" title="{{ 'Edit Google Integration' | translate}}" cancel="$hide()" hide-footer="true">
    <div class="modal-panel-container" block-ui="googleIntegrations">
        <div class="modal-panel-content" translate-params-email="$ctrl.googleAccount.email" translate>
            You are currently editing settings for <strong>{{email}}</strong>
        </div>
        <div class="modal-panel-content">
            <ul class="nav nav-tabs">
                <li ng-class="{ 'active' : $ctrl.activeTab == 'calendar' }">
                    <a ng-click="$ctrl.activeTab = 'calendar'">
                        <translate>Calendar</translate> &nbsp;
                        <i ng-if="!$ctrl.googleIntegration.calendar_integration" class="fa fa-circle-o"></i>
                        <i ng-if="$ctrl.googleIntegration.calendar_integration" class="fa fa-circle text-success"></i>
                    </a>
                </li>
                <li ng-class="{ 'active' : $ctrl.activeTab == 'gmail' }">
                    <a ng-click="$ctrl.activeTab = 'gmail'">
                        <translate>Gmail</translate> &nbsp;
                        <i ng-if="!$ctrl.googleIntegration.email_integration" class="fa fa-circle-o"></i>
                        <i ng-if="$ctrl.googleIntegration.email_integration" class="fa fa-circle text-success"></i>
                    </a>
                </li>
                <li ng-class="{ 'active' : $ctrl.activeTab == 'contacts' }">
                    <a ng-click="$ctrl.activeTab = 'contacts'">
                        <translate>Contacts</translate> &nbsp;
                        <i ng-if="!$ctrl.googleIntegration.contacts_integration" class="fa fa-circle-o"></i>
                        <i ng-if="$ctrl.googleIntegration.contacts_integration" class="fa fa-circle text-success"></i>
                    </a>
                </li>
                <li ng-class="{ 'active' : $ctrl.activeTab == 'setup' }">
                    <a ng-click="$ctrl.activeTab = 'setup'" translate>
                        Setup
                    </a>
                </li>
            </ul>
            <div ng-if="$ctrl.activeTab == 'calendar'">
                <div ng-if="!$ctrl.googleIntegration.calendar_integration">
                    <p translate>
                        MPDX can automatically update your google calendar with your tasks. Once you enable this feature, you'll be able
                        to choose which types of tasks you want to sync. By default MPDX will add 'Appointment' tasks to your calendar.
                    </p>
                    <div class="modal-footer">
                        <button class="btn btn-link" ng-click="$hide()" translate>Close</button>
                        <button class="btn btn-primary" ng-click="$ctrl.enable('calendar')" translate>Enable Calendar Integration</button>
                    </div>
                </div>
                <div ng-if="$ctrl.googleIntegration.calendar_integration">
                    <p translate>Choose a calendar for MPDX to push tasks to:</p>
                    <div class="form-group">
                        <select chosen
                                disable-search="true"
                                data-placeholder-text-single="'Select an Option' | translate"
                                class="form-control"
                                ng-options="calendar.id as calendar.name for calendar in $ctrl.googleIntegration.calendars"
                                ng-model="$ctrl.googleIntegration.calendar_id"
                                ng-change="$ctrl.save()"
                                ng-model-options="{ debounce: 1000 }"
                                autofocus="$ctrl.googleIntegration.calendar_integration">
                        </select>
                    </div>
                    <p translate>Choose which of tasks below you'd like MPDX to put on your calendar:</p>
                    <div class="row">
                        <div class="col-md-6" ng-repeat="activity in $ctrl.serverConstants.data.activity_hashes">
                            <div class="form-group">
                                <label>
                                    <input type="checkbox" checklist-value="activity.id" checklist-model="$ctrl.googleIntegration.calendar_integrations" ng-change="$ctrl.save()">
                                    &nbsp; {{activity.value}}
                                </label>
                            </div>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button class="btn btn-danger pull-left" ng-click="$ctrl.disable('calendar')" translate>Disable Calendar Integration</button>
                        <button class="btn btn-link" ng-click="$hide()" translate>Close</button>
                        <button class="btn btn-primary" ng-click="$ctrl.sync('calendar')" translate>Sync Calendar</button>
                    </div>
                </div>
            </div>
            <div ng-if="$ctrl.activeTab == 'gmail'">
                <p translate>
                    MPDX can automatically update your task history based on emails you've sent or received to/from your
                    contacts in your Gmail account.
                </p>
                <div ng-if="!$ctrl.googleIntegration.email_integration">
                    <div class="modal-footer">
                        <button class="btn btn-link" ng-click="$hide()" translate>Close</button>
                        <button class="btn btn-primary" ng-click="$ctrl.enable('email')" translate>Enable Gmail Integration</button>
                    </div>
                </div>
                <div ng-if="$ctrl.googleIntegration.email_integration">
                    <div class="modal-footer">
                        <button class="btn btn-danger pull-left" ng-click="$ctrl.disable('email')" translate>Disable Gmail Integration</button>
                        <button class="btn btn-link" ng-click="$hide()" translate>Close</button>
                        <button class="btn btn-primary" ng-click="$ctrl.sync('email')" translate>Sync Gmail</button>
                    </div>
                </div>
            </div>
            <div ng-if="$ctrl.activeTab == 'contacts'">
                <p translate>
                    MPDX can sync your active contacts to Google so you only have to keep your contacts up to date in one place.
                    (Active contacts are those whose status field indicates that they are partners or in the MPD process.)
                </p>
                <p translate>
                    This will synchronize existing contact information as well as future updates and deletions to your contact info
                    to and from MPDX and Google. Once the sync is active, changes in either Google or MPDX will be reflected in
                    the other system. If you make a change in both places between syncs, MPDX changes will take precedence.
                </p>
                <p translate>
                    If you make a contact inactive in MPDX e.g. by selecting "Not Interested" for its status, the contact info will
                    not be deleted in Google, but will be labeled "Inactive" so you can easily find those no-longer-synced contacts
                    and delete them if you choose.
                </p>
                <p translate>
                    If you delete a contact in Google contacts that is active in MPDX, you must also go in to MPDX and hide the
                    contact, making it inactive in MPDX. Otherwise, it will get regenerated in Google once it syncs again.
                <p>
                <div class="alert alert-danger" translate>
                    If a contact contains more than one person, a Google contact will be created for each person.
                    Spouses and other family members are not merged in this process.
                </div>
                <div class="alert alert-danger" translate>
                    Additionally, Google accounts which are heavily customized (groupings, etc) may cause sync issues with MPDX.
                </div>
                <div ng-if="!$ctrl.googleIntegration.contacts_integration">
                    <div class="modal-footer">
                        <button class="btn btn-link" ng-click="$hide()" translate>Close</button>
                        <button class="btn btn-primary" ng-click="$ctrl.enable('contacts')" translate>Enable Contacts Integration</button>
                    </div>
                </div>
                <div ng-if="$ctrl.googleIntegration.contacts_integration">
                    <div class="modal-footer">
                        <button class="btn btn-danger pull-left" ng-click="$ctrl.disable('contacts')" translate>Disable Contacts Integration</button>
                        <button class="btn btn-link" ng-click="$hide()" translate>Close</button>
                        <button class="btn btn-primary" ng-click="$ctrl.sync('contacts')" translate>Sync Contacts</button>
                    </div>
                </div>
            </div>
            <div ng-if="$ctrl.activeTab == 'setup'">
                <p translate>
                    If the link between MPDX and your Google account breaks, click the button below to re-establish the connection.
                    (You should only need to do this if you receive an email from MPDX)
                </p>
                <div class="modal-footer">
                    <button class="btn btn-link" ng-click="$hide()" translate>Close</button>
                    <a ng-href="{{ $ctrl.google.oAuth }}" class="btn btn-primary" translate>Refresh Google Account</a>
                </div>
            </div>
        </div>
    </div>
</modal>
